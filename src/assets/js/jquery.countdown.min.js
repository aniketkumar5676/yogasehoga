
/* Counter */
$(window).on('scroll', function() {
$('.ot-counter').each(function() {
var pos_y   = $(this).offset().top - window.innerHeight;
var $this   = $(this).find('span.num'),
countTo = $this.attr('data-to'),
during  = parseInt( $this.attr('data-time') ),
topOfWindow = $(window).scrollTop();

if ( pos_y < topOfWindow ) {    
$({
    countNum: $this.text()
}).animate({
    countNum: countTo
},
{
    duration: during,
    easing: 'swing',
    step: function() {
        $this.text(Math.floor(this.countNum));
    },
    complete: function() {
        $this.text(this.countNum);
    }
});
}
});

$('.ot-counter2').each(function() {
var pos_y   = $(this).offset().top - window.innerHeight;
var $this   = $(this).find('span.num'),
countTo = $this.attr('data-to'),
during  = parseInt( $this.attr('data-time') ),
topOfWindow = $(window).scrollTop();

if ( pos_y < topOfWindow ) {    
$({
    countNum: $this.text()
}).animate({
    countNum: countTo
},
{
    duration: during,
    easing: 'swing',
    step: function() {
        $this.text(Math.floor(this.countNum));
    },
    complete: function() {
        $this.text(this.countNum);
    }
});
}
});

$('.ot-progress').each(function() {
var pos_y = $(this).offset().top;
var value = $(this).find(".progress-bar").data('percent');
var topOfWindow = $(window).scrollTop();
if (pos_y < topOfWindow + 900) {
$(this).find(".progress-bar").css({
    'width': value
}, "slow");
}
});

$('.circle-progress').each(function() {
var bar_color = $(this).data('color');
var bar_hei   = $(this).data('height');
var bar_size  = $(this).data('size');
var pos_y = $(this).offset().top;
var topOfWindow = $(window).scrollTop();
if (pos_y < topOfWindow + 900) {
$(this).find('.inner-bar').easyPieChart({
    barColor: bar_color,
    trackColor: false,
    scaleColor: false,
    lineCap: 'square',
    lineWidth: bar_hei,
    size: bar_size,
    animate: 1000,
    onStart: $.noop,
    onStop: $.noop,
    easing: 'easeOutBounce',
    onStep: function(from, to, percent) {
        $(this.el).find('.percent').text(Math.round(percent)) + '%';
    }
});
}
});

$('.ot-chart-bar:not([data-processed])').each(function() {
var bar = $(this),
chart = bar.find('.col-chart'),
innerBar = bar.find('.inner-bar'),
heightChart = bar.data('height'),
progressEnd = bar.data('percent'),
percentText = bar.find('.percent');
var scrollTop = $(document).scrollTop() + $(window).height();

if ( scrollTop > bar.offset().top +  bar.height() ) {
bar.attr("data-processed", "true");
chart.css({ "height": heightChart + "px", "animation" : "slide-up 1.5s ease-in-out"});
innerBar.css({ "height": heightChart + "px"});

if( progressEnd ){
    for (var i = 0; i <= 50; i++) {
        (function (count) {
            setTimeout(function () {
                var num = ((progressEnd / 50) * count) + Number.EPSILON;
                percentText.html(Math.round(num * 100) / 100 + "%");
            }, 30 * count);
        })(i);
    }
}

}
});
});


$('.ot-accordions').each( function () {
var allPanels = $(this).find('.acc-content');
$(this).find('.acc-toggle').on( 'click', function(){

var $this = $(this),
$target = $this.next();

if(!$target.hasClass('active')){
allPanels.removeClass('active').slideUp(300);
allPanels.parent().removeClass('current');
$target.addClass('active').slideDown(300);
$target.parent().addClass('current');
}

return false;
});
$(this).find('.acc-toggle:first').trigger('click');
});

$('.ot-acc--with-icon').each( function () {
var selector = $(this),
content  = selector.find('.ot-acc-item__content'),
trigger  = selector.find('.ot-acc-item__trigger');

trigger.off("click");

trigger.each(function(){
if ($(this).data('default') == 'yes') {
$(this).next().addClass('active').slideDown(300);
$(this).parent().addClass('current');
}
});

trigger.on('click', function(e){
e.preventDefault();
var $this = $(this);
$this.next().toggleClass('active').slideToggle(300);
$this.parent().toggleClass('current');
content.not($this.next()).slideUp(300);
trigger.not($this).parent().removeClass('current');
});
});


$('.ot-tabs').each(function() {
$(this).find('.tabs-heading li').first().addClass('current');
$(this).find('.tab-content').first().addClass('current');
});

$('.tabs-heading li').on( 'click', function(){
var tab_id = $(this).attr('data-tab');
$(this).siblings().removeClass('current');
$(this).parents('.ot-tabs').find('.tab-content').removeClass('current');
$(this).addClass('current');
$("#"+tab_id).addClass('current');
});
